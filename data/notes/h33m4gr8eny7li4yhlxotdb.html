<h1 id="qgis-and-map-sample-gestion">QGIS and map sample gestion<a aria-hidden="true" class="anchor-heading icon-link" href="#qgis-and-map-sample-gestion"></a></h1>
<p>QGIS (<a href="/dendron-dbgi/notes/lmex82qnbgssu3apk4t7v5f">_g</a>) is an open source Geographic Information Software that permits to manage a lot of different geographic data. We use it to display the drone map and to add sample points.</p>
<p>To do that, we have made a QGIS project with the drone map as base. The project can be joined creating a QFieldCloud account <a href="https://app.qfield.cloud/accounts/login/">here</a>.</p>
<p>To add points, we make a new vector point layer for each sampling period. For now, Two batches are available, one for the SBL.20004 curse and one for this Bachelor Work.</p>
<h2 id="connection-to-the-qgis-project">Connection to the QGIS project<a aria-hidden="true" class="anchor-heading icon-link" href="#connection-to-the-qgis-project"></a></h2>
<p>Firstly, you have to <a href="https://qgis.org/downloads/QGIS-OSGeo4W-3.22.7-1.msi">download</a> QGIS. Then open the software and install the QField Sync plugin under <em>Plugins/Manage and Install Plugins/QField Sync/Install Plugin</em>, and enter your QFieldCloud login. When it's done, you have to connect you to the <a href="https://app.qfield.cloud/a/edouardbrulhart/DBGI/">project</a> with your QFieldCloud account. Then, go in QGIS to <em>Plugins/QFieldSync/QFieldCloud Projects Overview</em>. Here you will normally see the project. If not, clik on the <em>refresh</em> button on the bottom right. When you see the DBGI project, click on it and <em>synchronize</em>. A new page will open, select <em>Prefer Cloud</em> and controll that all the ticks are under the little cloud ont the window above. Then click <em>Perform Actions</em>. The files are big, so it will probably take some time to download the project.</p>
<p><img src="/dendron-dbgi/assets/images/QGIS_synchronisation.png" alt="Build settings orthomosaic" style="max-width:600px;display:block;margin:0 auto;"><em>How to obtain the synchronized QGIS project</em></p>
<p>Now you have the project synced. If you want to upload changes from QGIS to the server, you can choose <em>Prefer Local</em> and if you want to download changes from server to QGIS, you can choose <em>Prefer Cloud</em> from Synchronizing project window.</p>
<h2 id="creation-of-a-new-point-layer">Creation of a new point layer<a aria-hidden="true" class="anchor-heading icon-link" href="#creation-of-a-new-point-layer"></a></h2>
<p>This step has not been tested from another computer as the one who host the project. If you can't create a new layer by your own, please contact <a href="/dendron-dbgi/mailto:edouard.bruelhart@unifr.ch">edouard.bruelhart@unifr.ch</a> to find a solution.</p>
<p>Before going to sample on the field, we have to create a new layer for the harvesting :</p>
<ul>
<li>Right click on the <em>Other samples</em> layer in QGIS, <em>Export/Save Feature As</em>. On the <em>Save Vector Layer as...</em> choose the GeoPackage Format, in the File name add the layer in "C:\Users\edoua\QField\cloud\dbgi". Tick the <em>Replace all selected raw field values by displayed values</em> and then click <em>OK</em>.</li>
<li>Go to <em>Project/Properties/Relations</em> and click <em>Add Relation</em> in the bottom. In the Referenced field enter <em>Species list QGIS</em> and select the field <em>idTaxon</em>. In the Referencing field entre <em>Name of your new layer</em> and select the field <em>Plant_ID</em>. Set the Relation strength to <em>Association</em> and then confirm by <em>OK</em>. Click on the bottom of Project Properties <em>Apply</em> and then <em>OK</em>.</li>
<li>Right click on your new layer <em>Properties/Attribute Form</em> and renseign the field like in the the <em>other samples</em> layer, exept in <em>Plant_ID</em> field where you have to select the relation you created.</li>
<li>Upload the changes with the <em>QFieldSync</em> plugin.</li>
</ul>
<h2 id="utilisation-on-the-field">Utilisation on the field<a aria-hidden="true" class="anchor-heading icon-link" href="#utilisation-on-the-field"></a></h2>
<p>1) Download the QField <a href="https://play.google.com/store/apps/details?id=ch.opengis.qfield">application</a>. For now, only Android smartphones are available, but an IOS application seems to be in progess.</p>
<p>2) Open the application and login to QFieldCloud.</p>
<p>3) Go to <em>QFieldCloud Projects</em> and select the DBGI one to download on the smartphone. This step can take several minutes.</p>
<p>4) When the project is open, go to the left menu and select your layer. Then click on the pencil at the top right to pass in edition mode. You can now add the harvested samples by searching and selecting it in the Plant_ID. Don't forget to add the DBG sample code. All the other fields will be automatically filled. If, for any reason, the sample is not available in this field, select <em>aaunknown</em> parameter and fill the <em>unknown</em> field with the name of the sampled plant.</p>
<p>5) After the sample cession, reopen the left menu and click on the cloud. You just have to select <em>Push the modifications</em> to upload the modifications made on the server. You can then download them to the QGIS project on the computer.</p>
<p>6) To obtain the location data, you just have to right click on the updated layer with the points on QGIS <em>Export/Save Feature As/CSV Format</em> and choose the location of the CSV.</p>